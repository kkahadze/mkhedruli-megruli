<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mingrelian Translator</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        .container {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        input[type="text"], 
        input[type="password"],
        textarea,
        select {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
        }
        textarea {
            min-height: 100px;
        }
        button {
            background-color: #4CAF50;
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background-color: #45a049;
        }
        .result {
            margin-top: 20px;
            border: 1px solid #ddd;
            padding: 15px;
            border-radius: 4px;
            background-color: #f9f9f9;
        }
        .hidden {
            display: none;
        }
        .error {
            color: red;
            font-weight: bold;
        }
        .loading {
            text-align: center;
            margin: 20px 0;
        }
        .clear-settings {
            color: #666;
            font-size: 12px;
            cursor: pointer;
            text-decoration: underline;
            display: inline-block;
            margin-top: 5px;
        }
        .clear-settings:hover {
            color: #d9534f;
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        table, th, td {
            border: 1px solid #ddd;
        }
        th, td {
            padding: 10px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
    </style>
</head>
<body>
    <h1>Mingrelian Translator</h1>
    
    <div class="container">
        <div class="form-group">
            <label for="apiKey">OpenAI API Key:</label>
            <input type="password" id="apiKey" placeholder="sk-..." />
            <div style="margin-top: 5px;">
                <label style="font-weight: normal; font-size: 14px;">
                    <input type="checkbox" id="rememberKey" style="width: auto; margin-right: 5px;" />
                    Remember my API key (stored locally in your browser)
                </label>
                <span class="clear-settings" id="clearSettings" style="margin-left: 15px;">Clear saved settings</span>
            </div>
            <small>Your API key is used only for this request and stored locally in your browser if you choose to remember it.</small>
        </div>
        
        <div class="form-group">
            <label for="model">AI Model:</label>
            <select id="model">
                <optgroup label="OpenAI GPT-5 (Latest)">
                    <option value="gpt-5-2025-08-07">GPT-5 (Latest)</option>
                </optgroup>
                <optgroup label="OpenAI GPT-4o">
                    <option value="gpt-4o" selected>GPT-4o (Recommended)</option>
                    <option value="gpt-4o-mini">GPT-4o Mini (Faster, Cheaper)</option>
                </optgroup>
                <optgroup label="OpenAI GPT-4">
                    <option value="gpt-4-turbo">GPT-4 Turbo</option>
                    <option value="gpt-4">GPT-4</option>
                </optgroup>
                <optgroup label="OpenAI GPT-3.5">
                    <option value="gpt-3.5-turbo">GPT-3.5 Turbo (Fastest, Cheapest)</option>
                </optgroup>
            </select>
            <small>Choose the AI model for translation. GPT-4o is recommended for best quality.</small>
        </div>
        
        <div class="form-group">
            <label for="targetLang">Target Language:</label>
            <select id="targetLang">
                <option value="english">English</option>
                <option value="georgian">Georgian</option>
            </select>
        </div>
        
        <div class="form-group">
            <label for="mingrelianText">Mingrelian Text:</label>
            <textarea id="mingrelianText" placeholder="Enter Mingrelian text here (latinized or mkhedruli)"></textarea>
        </div>
        
        <button id="translateBtn">Translate</button>
        
        <div id="loading" class="loading hidden">
            <p>Translating... This may take a few seconds...</p>
        </div>
        
        <div id="error" class="error hidden"></div>
        
        <div id="resultContainer" class="result hidden">
            <h2>Translation Results</h2>
            <table>
                <tr>
                    <th>Language</th>
                    <th>Text</th>
                </tr>
                <tr>
                    <td>Mingrelian (Latinized)</td>
                    <td id="mingrelianLatinized"></td>
                </tr>
                <tr>
                    <td>Mingrelian (Mkhedruli)</td>
                    <td id="mingrelianMkhedruli"></td>
                </tr>
                <tr>
                    <td>Georgian</td>
                    <td id="georgian"></td>
                </tr>
                <tr>
                    <td>English</td>
                    <td id="english"></td>
                </tr>
            </table>
            
            <div class="form-group" style="margin-top: 20px;">
                <label for="fullResponse">Full Response:</label>
                <textarea id="fullResponse" readonly></textarea>
            </div>
        </div>
    </div>
    
    <script>
        // Load saved preferences from localStorage on page load
        window.addEventListener('DOMContentLoaded', function() {
            const savedApiKey = localStorage.getItem('mingrelian_api_key');
            const savedModel = localStorage.getItem('mingrelian_model');
            const savedTargetLang = localStorage.getItem('mingrelian_target_lang');
            const rememberKey = localStorage.getItem('mingrelian_remember_key') === 'true';
            
            // Restore API key if saved
            if (savedApiKey && rememberKey) {
                document.getElementById('apiKey').value = savedApiKey;
                document.getElementById('rememberKey').checked = true;
            }
            
            // Restore model preference if saved
            if (savedModel) {
                document.getElementById('model').value = savedModel;
            }
            
            // Restore target language preference if saved
            if (savedTargetLang) {
                document.getElementById('targetLang').value = savedTargetLang;
            }
        });
        
        // Save preferences when "Remember Key" checkbox changes
        document.getElementById('rememberKey').addEventListener('change', function() {
            const isChecked = this.checked;
            localStorage.setItem('mingrelian_remember_key', isChecked);
            
            if (isChecked) {
                // Save current API key
                const apiKey = document.getElementById('apiKey').value.trim();
                if (apiKey) {
                    localStorage.setItem('mingrelian_api_key', apiKey);
                }
            } else {
                // Clear saved API key
                localStorage.removeItem('mingrelian_api_key');
            }
        });
        
        // Save API key when it changes (if remember is checked)
        document.getElementById('apiKey').addEventListener('input', function() {
            if (document.getElementById('rememberKey').checked) {
                localStorage.setItem('mingrelian_api_key', this.value.trim());
            }
        });
        
        // Save model preference when it changes
        document.getElementById('model').addEventListener('change', function() {
            localStorage.setItem('mingrelian_model', this.value);
        });
        
        // Save target language preference when it changes
        document.getElementById('targetLang').addEventListener('change', function() {
            localStorage.setItem('mingrelian_target_lang', this.value);
        });
        
        // Clear all saved settings
        document.getElementById('clearSettings').addEventListener('click', function() {
            if (confirm('Are you sure you want to clear all saved settings (API key, model, language)?')) {
                localStorage.removeItem('mingrelian_api_key');
                localStorage.removeItem('mingrelian_model');
                localStorage.removeItem('mingrelian_target_lang');
                localStorage.removeItem('mingrelian_remember_key');
                
                // Clear form
                document.getElementById('apiKey').value = '';
                document.getElementById('rememberKey').checked = false;
                document.getElementById('model').value = 'gpt-4o';
                document.getElementById('targetLang').value = 'english';
                
                alert('All saved settings have been cleared!');
            }
        });
        
        document.getElementById('translateBtn').addEventListener('click', async function() {
            // Get values from form
            const apiKey = document.getElementById('apiKey').value.trim();
            const model = document.getElementById('model').value;
            const targetLang = document.getElementById('targetLang').value;
            const mingrelianText = document.getElementById('mingrelianText').value.trim();
            
            // Validate inputs
            if (!apiKey) {
                showError('Please enter your OpenAI API key');
                return;
            }
            
            if (!mingrelianText) {
                showError('Please enter Mingrelian text to translate');
                return;
            }
            
            // Hide any previous results or errors
            document.getElementById('error').classList.add('hidden');
            document.getElementById('resultContainer').classList.add('hidden');
            
            // Show loading indicator with model name
            const modelName = document.getElementById('model').options[document.getElementById('model').selectedIndex].text;
            document.getElementById('loading').innerHTML = `<p>Translating with ${modelName}... This may take a few seconds...</p>`;
            document.getElementById('loading').classList.remove('hidden');
            
            try {
                // Make API request
                const response = await fetch('https://argo-translator.onrender.com/chat', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        prompt: mingrelianText,
                        api_key: apiKey,
                        target_language: targetLang,
                        model: model,
                        provider: 'openai'
                    })
                });
                
                // Hide loading indicator
                document.getElementById('loading').classList.add('hidden');
                
                if (!response.ok) {
                    const errorData = await response.json();
                    showError(`API error: ${errorData.detail || response.statusText}`);
                    return;
                }
                
                // Process successful response
                const data = await response.json();
                
                // Update the result fields
                document.getElementById('mingrelianLatinized').textContent = data.mingrelian_latinized;
                document.getElementById('mingrelianMkhedruli').textContent = data.mingrelian_mkhedruli;
                document.getElementById('georgian').textContent = data.georgian;
                document.getElementById('english').textContent = data.english;
                document.getElementById('fullResponse').value = data.full_response;
                
                // Show the result container
                document.getElementById('resultContainer').classList.remove('hidden');
                
            } catch (error) {
                console.error('Error:', error);
                showError(`Network error: ${error.message}`);
                document.getElementById('loading').classList.add('hidden');
            }
        });
        
        function showError(message) {
            const errorElement = document.getElementById('error');
            errorElement.textContent = message;
            errorElement.classList.remove('hidden');
        }
    </script>
</body>
</html> 